<!DOCTYPE html>
<html>
<head>
	<title>ScratchBot</title>
	<!--<link rel="stylesheet" type="text/css" href="bootstrap.css">-->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="style.css">
	<!--Author: Yifan He-->
  	<script src="blockly/blockly_compressed.js"></script>
  	<script src="blockly/blocks_compressed.js"></script>
  	<script src="blockly/msg/js/en.js"></script>
  	<script src="blockly/javascript_compressed.js"></script>
<body>

	<nav class="navbar navbar-default">
		<div class="container">
			<div class="navbar-header">
				<a href="index.html" class="navbar-brand">ScratchBot</a>
			</div>
			<ul class="nav navbar-nav">
				<li><a href="index.html">Home</a></li>
				<li><a href="about.html">About</a></li>
				<li><a href="help.html">Help</a></li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li><a href="login.html">Login</a></li>
				<li><a href="register.html">Signup</a></li>
			</ul>
		</div>
	</nav>

	<div class="container">
		<div id="blocklyDiv" style="height:400px;width:100%;"></div>
		<p>
    		<button onclick="showCode()">Show JavaScript</button>
    		<button onclick="runCode()">Run JavaScript</button>
  		</p>
		<p id="codeViewer"></p>
	</div>

		<xml id="toolbox" style="display:none">
		<block type="controls_if"></block>
		<block type="logic_compare"></block>
		<block type="math_number"></block>
		<block type="math_arithmetic"></block>
	</xml>

	<xml id="startBlocks" style="display: none">
    <block type="controls_if" inline="false" x="20" y="20">
      <mutation else="1"></mutation>
      <value name="IF0">
        <block type="logic_compare" inline="true">
          <field name="OP">EQ</field>
          <value name="A">
            <block type="math_number">
              <field name="NUM">42</field>
            </block>
          </value>
          <value name="B">
            <block type="math_number">
              <field name="NUM">42</field>
            </block>
          </value>
        </block>
      </value>
      <statement name="DO0">
        <block type="text_print" inline="false">
          <value name="TEXT">
            <block type="text">
              <field name="TEXT">Don't panic</field>
            </block>
          </value>
        </block>
      </statement>
      <statement name="ELSE">
        <block type="text_print" inline="false">
          <value name="TEXT">
            <block type="text">
              <field name="TEXT">Panic</field>
            </block>
          </value>
        </block>
      </statement>
    </block>
  </xml>
	<script>
	var workspace = Blockly.inject('blocklyDiv',
	    {media: 'media/',
	     toolbox: document.getElementById('toolbox')});

	Blockly.Xml.domToWorkspace(document.getElementById('startBlocks'),workspace);

	function showCode() {
	  // Generate JavaScript code and display it.
	  Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
	  var code = Blockly.JavaScript.workspaceToCode(workspace);
	  document.getElementById("codeViewer").innerHTML = code;
	}

	function runCode() {
	  // Generate JavaScript code and run it.
	  window.LoopTrap = 1000;
	  Blockly.JavaScript.INFINITE_LOOP_TRAP =
	      'if (--window.LoopTrap == 0) throw "Infinite loop.";\n';
	  var code = Blockly.JavaScript.workspaceToCode(workspace);
	  Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
	  try {
	    eval(code);
	    // document.getElementById("codeViewer").innerHTML = result;
	  } catch (e) {
	    alert(e);
	  }
	}
	</script>

</body>
</html>
